---
title: "ã‚¼ãƒ­ã‹ã‚‰ä½œã‚‹Catsãƒ©ã‚¤ãƒ–ãƒ©ãƒª ~ å‹ã‚¯ãƒ©ã‚¹ç·¨ ~"
emoji: "ğŸ±"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Scala"]
published: false
---

# ã¯ã˜ã‚ã«
ã¯ã˜ã‚ã¾ã—ã¦ã€‚ã‚„ãŒã§ã™ã€‚æ™®æ®µã¯Scalaã‚’ç”¨ã„ã¦ä¿è‚²åœ’ã®æ¥­å‹™æ”¯æ´SaaSã®é–‹ç™ºã‚’ã—ã¦ã„ã¾ã™ã€‚
Zennã¯åˆæŠ•ç¨¿ã«ãªã‚Šã¾ã™ğŸ’ª

ç­†è€…ã¯é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«å…¥é–€ã—ãŸã°ã‹ã‚Šã§ã‚ã‚‹ãŸã‚ã€ãªã‚‹ã¹ãèª¤ã‚ŠãŒãªã„ã‚ˆã†è©¦è¡ŒéŒ¯èª¤ã—ãªãŒã‚‰è¨˜äº‹ã‚’æ›¸ã„ã¦ã„ã¾ã™ãŒã€ã‚‚ã—èª¤ã£ã¦ã„ã‚‹ç‚¹ç­‰ãŒã‚ã‚Œã°ã‚³ãƒ¡ãƒ³ãƒˆã§æŒ‡æ‘˜ã—ã¦ã„ãŸã ã‘ã‚‹ã¨ã¨ã¦ã‚‚å¬‰ã—ã„ã§ã™ã€‚

## Catsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ¦‚è¦
Catsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯Scalaè¨€èªã§ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚åå‰ã®ç”±æ¥ã¯åœ(*category*)ã®çœç•¥ç³»ã§ã‚ã‚‹ã¨å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«å¤§ããªå½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹åœè«–ã¨ã®ç¹‹ãŒã‚Šã‚’æ„Ÿã˜ã¾ã™ã­ã€‚

Catsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ãƒ„ãƒ¼ãƒ«ã®ã‚ˆã†ãªã‚‚ã®ãŒå¤šãç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ãã—ã¦ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã®å¤§éƒ¨åˆ†ã¯å‹ã‚¯ãƒ©ã‚¹ã¨å‘¼ã°ã‚Œã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

æœ¬è¨˜äº‹ã§ã¯ãã®å‹ã‚¯ãƒ©ã‚¹ã«ã¤ã„ã¦ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’äº¤ãˆã¦ç´¹ä»‹ã‚’ã—ã¦ã„ãã¾ã™ã€‚

## æœ¬è¨˜äº‹ã®å†…å®¹

æœ¬è¨˜äº‹ã®ã‚´ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆã‚’é€šã™ã“ã¨ã§ã™ã€‚

```scala
...

class OptionInstancesTest extends AnyFunSuite {
  test("semigroup") {
    assert((Option(3)  |+| Option(4)) == Option(7))
    assert((Option(10) |+| Option(5)) == Option(15))
  }
}
```

ä»¥ä¸Šã®ãƒ†ã‚¹ãƒˆã§ã¯ã€`Option[Int]`å‹ã§ã‚ã‚‹2ã¤ã®å€¤ã‚’ã€`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚Š1ã¤ã®å€¤ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚**ã¾ã¨ã‚ã‚‹**ã¨æ›¸ãã¾ã—ãŸãŒã€å…·ä½“çš„ã«ã¯2ã¤ã®`Option[Int]å‹`ã®å€¤ãŒå†…åŒ…ã™ã‚‹`Int`å‹ã®å€¤ã‚’åŠ ç®—ã—ãŸçµæœã‚’ã€1ã¤ã®`Option[Int]`å‹ã«åŒ…ã‚“ã§è¿”ã™ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªå‡¦ç†ã§ã™ã€‚

`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã¯Scalaæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯å®Ÿè£…ã•ã‚Œã¦ãŠã‚‰ãšã€Scalaã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã¿ã§ã¯ä»¥ä¸Šã®ãƒ†ã‚¹ãƒˆã¯é€šã‚Šã¾ã›ã‚“ã€‚æœ¬è¨˜äº‹ã§ã¯`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æä¾›ã™ã‚‹`Additive`ã¨ã„ã†åå‰ã®å‹ã‚¯ãƒ©ã‚¹ã‚’ã‚¼ãƒ­ã‹ã‚‰å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

:::message
Catsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãŠã„ã¦`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€`Semigroup`ã‚„`Monoid`ã¨ã„ã£ãŸå‹ã‚¯ãƒ©ã‚¹ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã¾ã™ãŒã€æœ¬è¨˜äº‹ã§ã¯ãã‚Œã‚‰ã®è©³ã—ã„èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚
:::

# å‹ã‚¯ãƒ©ã‚¹ã¨ã¯
## å‹ã‚¯ãƒ©ã‚¹ã®æ¦‚è¦
å‹ã‚¯ãƒ©ã‚¹ã¨ã¯Haskellã«ç”±æ¥ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚å‹ã‚¯ãƒ©ã‚¹ã¯æ—¢å­˜ã®ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ã‚„æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›´ã‚’åŠ ãˆã‚‹ã“ã¨ãªãã€æ–°ã—ã„æ©Ÿèƒ½ã‚’æ‹¡å¼µã—ã¦è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ä¾‹ã«æŒ™ã’ã‚‹ã¨ã€`Option[Int]`å‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨æ„ã™ã‚‹ãŸã‚ã«ã¯ã€é€šå¸¸ã®`trait`ã‚’ç”¨ã„ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªå®Ÿè£…ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚ï¼ˆã‚ãã¾ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚ï¼‰

```scala
trait Additive[A] {
  def |+|(rhs: A): A
}

class Option[T](value: T) extends Additive[Option[T]] {
  def |+|(rhs: Option[T]): Option[T] = Option(value + rhs.value)
}
```
ã—ã‹ã—ã€`Option[T]`å‹ã¯Scalaã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹æ—¢å­˜ã®ã‚¯ãƒ©ã‚¹ã§ã‚ã‚‹ãŸã‚ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã®ã‚ˆã†ã«å¾Œã‹ã‚‰ã‚¯ãƒ©ã‚¹å®šç¾©ã‚’æ›¸ãæ›ãˆã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

ä»¥ä¸Šã®ã‚ˆã†ãªå•é¡Œã‚’è§£æ±ºã™ã‚‹ã®ãŒå‹ã‚¯ãƒ©ã‚¹ã§ã™ã€‚

ã‚ˆã‚Šå°‚é–€çš„ãªè¨€è‘‰ã‚’ç”¨ã„ã‚‹ã¨ã€**ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯å¤šç›¸ã‚’å®Ÿç¾ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³**ã¨ã„ã£ãŸã‚ˆã†ãªèª¬æ˜ãŒæ­£ã—ã„ã‚ˆã†ã«å­¦ã‚“ã§ã„ã¾ã™ã€‚

**ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯**ã¨ã„ã†å˜èªã¯ã€Œè‡¨æ™‚ã®ãƒ»æš«å®šçš„ãªãƒ»å ´å½“ãŸã‚Šçš„ãªã€ã¨ã„ã£ãŸã‚ˆã†ãªæ„å‘³ã‚’æŒã¤ã‚ˆã†ãªã®ã§ã€æ—¢ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦ã‚‚**å ´å½“ãŸã‚Šçš„ã«**ä½•ã‚‰ã‹ã®ç‰¹æ€§ï¼ˆå‹ã‚¯ãƒ©ã‚¹ï¼‰ã‚’è¿½åŠ ã™ã‚‹äº‹ãŒã§ãã‚‹ã¨ã„ã£ãŸèªè­˜ã§ã™ã€‚

## Scalaã«ãŠã‘ã‚‹å‹ã‚¯ãƒ©ã‚¹
Scalaã§ã¯`implicit`ã®æ©Ÿèƒ½ã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€å‹ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚

Scalaã®å‹ã‚¯ãƒ©ã‚¹ã¯ä¸»ã«ä»¥ä¸‹ã®4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚ˆã£ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
1. `trait`ã«ã‚ˆã‚‹å‹ã‚¯ãƒ©ã‚¹å®šç¾©
2. `implicit value`ã«ã‚ˆã‚‹å‹ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å®šç¾©
3. `implicit parameter`ã«ã‚ˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©
4. `Enrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ`implicit conversion`ï¼‰ã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¹æ‹¡å¼µ

`implicit`ã®æ©Ÿèƒ½ã‚’çŸ¥ã‚‰ãªã„æ–¹ã‹ã‚‰ã™ã‚‹ã¨çŸ¥ã‚‰ãªã„å˜èªãŒä¸¦ã‚“ã§ã„ã‚‹ã¨æ€ã†ã®ã§ã€æ¬¡ã«`implicit`ãŒå…·ä½“çš„ã«ã©ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æŒã£ã¦ã„ã‚‹ã‹ã‚’è¦‹ã¦ã„ãã¾ã™ã€‚

# implicitã®æ©Ÿèƒ½
`implicit`ã¯ã€Œæš—é»™çš„ãªã€ã¨ã„ã†æ„å‘³ã‚’æŒã¤å˜èªã§ã™ã€‚ä»¥ä¸‹ã€é †ã«`implicit`ã®æ©Ÿèƒ½ã‚’ç´¹ä»‹ã—ã¦ã„ãã¾ã™ã€‚

## implicit parameter
`implicit parameter`ã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã‚¯ãƒ©ã‚¹ã®å¼•æ•°ã‚’æš—é»™çš„ã«æ¸¡ã™äº‹ãŒã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚

`implicit parameter`ã¯æš—é»™çš„ã«æ¸¡ã—ãŸã„å¼•æ•°ã‚°ãƒ«ãƒ¼ãƒ—ã«`implicit`ä¿®é£¾å­ã‚’ã¤ã‘ã‚‹äº‹ã§ä½¿ç”¨ã—ã¾ã™ã€‚

ãã—ã¦`implicit`ä¿®é£¾å­ã«ã‚ˆã‚‹å¼•æ•°ã«å€¤ã‚’æ¸¡ã™ãŸã‚ã«ã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã‚¯ãƒ©ã‚¹ã‚’å‘¼ã³å‡ºã™å‡¦ç†ã®ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«ã€å¼•æ•°ã®å‹ã«å¯¾å¿œã—ãŸæš—é»™çš„ãªå€¤ï¼ˆä»¥ä¸‹ã€`implicit value`ï¼‰ãŒãŸã ä¸€ã¤å®šç¾©ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
`implicit`ä¿®é£¾å­ã‚’ç”¨ã„ãŸå¼•æ•°ã‚’æŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™ã€‚
```scala
scala> def showGreet(name: String)(implicit greet: String): String = s"$greet $name"
// def showGreet(name: String)(implicit greet: String): String
```
æŒ¨æ‹¶ã®æ–‡å­—åˆ—ã‚’è¡¨ã™`greet`å¼•æ•°ã¯æš—é»™çš„ã«æ¸¡ã™ãŸã‚ã€`showGreet("hoge")`ã®å½¢ã§ã€`name`å¼•æ•°ã®ã¿ã§ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

å®Ÿéš›ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã‚“ã§ã¿ã¾ã—ã‚‡ã†ã€‚
```scala
scala> showGreet("yaga")
/*              ^
       error: could not find implicit value for parameter greet: String
 */
```
`greet`å¼•æ•°ã®ãŸã‚ã®`implicit value`ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã¨ã„ã†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸã€‚

`implicit value`ã¯é€šå¸¸ã®å€¤å®šç¾©ã«`implicit`ä¿®é£¾å­ã‚’ã¤ã‘ã‚‹äº‹ã§å®šç¾©ã—ã¾ã™ã€‚
```scala
scala> implicit val hello: String = "Hello"
// val hello: String = Hello
```
`implicit parameter`ã¯å¼•æ•°ã®**å‹**ã«å¯¾å¿œã™ã‚‹`implicit value`ã‚’å¿…è¦ã¨ã™ã‚‹ãŸã‚ã€å€¤ã®åå‰ãŒç•°ãªã£ã¦ã„ã¦ã‚‚å•é¡Œã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

å†åº¦ã€`showGreet`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã‚“ã§ã¿ã¾ã™ã€‚
```scala
scala> showGreet("yaga")
// val res1: String = Hello yaga
```
ä»Šåº¦ã¯æ­£å¸¸ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™äº‹ãŒã§ãã¾ã—ãŸğŸ‘

ä»¥ä¸ŠãŒ`implicit parameter`ã®æ©Ÿèƒ½ã®æ¦‚è¦ã¨ãªã‚Šã¾ã™ã€‚

:::message
`implicit`ä¿®é£¾å­ã«ã‚ˆã‚‹å¼•æ•°ã®å‹ã«å¯¾å¿œã™ã‚‹`implicit value`ãŒè¤‡æ•°å®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã™ã€‚
:::
```scala
scala> implicit val hello: String = "Hello"
// val hello: String = Hello

scala> implicit val goodMorning: String = "Good Morning"
// val goodMorning: String = Good Morning

scala> showGreet("yaga")
/*              ^
       error: ambiguous implicit values:
        both value hello of type String
        and value goodMorning of type String
        match expected type String
 */
```

### ãã®ä»–è£œè¶³
`implicit value`ã¯`val`ã ã‘ã§ã¯ãªã`def`ã‚’ç”¨ã„ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
```scala
implicit def foo: String = ...
```

`def`ã‚’ç”¨ã„ã‚‹ã¨ã€å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
```scala
implicit def foo[T]: Option[T] = ...
```

`implicit value`ãŒ`implicit parameter`ã‚’æŒã¤ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
```scala
implicit def foo[T](implicit a: T): Option[T] = ...
```

## implicit conversion
`implicit conversion`ã¯`implicit`ä¿®é£¾å­ã‚’æŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã®å‹ã‹ã‚‰è¿”ã‚Šå€¤ã®å‹ã¸ã¨æš—é»™çš„ãªå‹å¤‰æ›ã‚’è¡Œã†æ©Ÿèƒ½ã§ã™ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
ä¾‹ã¨ã—ã¦ã€`Int`å‹ã‹ã‚‰`String`å‹ã¸ã®æš—é»™çš„ãªå‹å¤‰æ›ã‚’è¡Œã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
```scala
scala> implicit def intToString(a: Int): String = a.toString
// def intToString(a: Int): String
```

ãã—ã¦å—ã‘å–ã£ãŸ`String`å‹ã®å€¤ã‚’ãã®ã¾ã¾è¿”ã™ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚
```scala
scala> def receiveString(a: String): String = a
// def receiveString(a: String): String
```

`receiveString`ã«`Int`å‹ã®å€¤ã‚’æ¸¡ã—ã¦ã¿ã¾ã™ã€‚é€šå¸¸ã¯å¼•æ•°ã«ä¸ãˆã‚‹å‹ãŒ`String`å‹ã§ã¯ãªã„ãŸã‚,`type mismatch`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€`implicit conversion`ã«ã‚ˆã‚Šã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚Šã¾ã™ã€‚
```scala
scala> receiveString(3)
// val res0: String = 3
```

`implicit conversion`ã¯ä¸€è¦‹ä¾¿åˆ©ãªæ©Ÿèƒ½ã«è¦‹ãˆã¾ã™ã€‚ã—ã‹ã—ã€ä¸Šè¨˜ã®ã‚ˆã†ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã‚’ç°¡å˜ã«ã™ã‚ŠæŠœã‘ã‚‹ç­‰ã®ç†ç”±ã‹ã‚‰ã€æ¬¡ã«ç´¹ä»‹ã™ã‚‹`Enrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ä»¥å¤–ã§ã®ä½¿ç”¨ã¯ã€ãšã„ã¶ã‚“å‰ã‹ã‚‰éæ¨å¥¨ã¨ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

## Enrich my libraryãƒ‘ã‚¿ãƒ¼ãƒ³
`Enrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã¯`implicit conversion`ã®æ©Ÿèƒ½ã‚’ç”¨ã„ã¦ã€æ—¢å­˜ã‚¯ãƒ©ã‚¹ã®æ‹¡å¼µã‚’è¡Œã†å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚æ—¥æœ¬èªã§ã¯**æ‹¡å¼µãƒ¡ã‚½ãƒƒãƒ‰**ã¨ã„ã†åå‰ã§å‘¼ã°ã‚Œã¦ã„ã¾ã™ã€‚

### ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
ä¾‹ã¨ã—ã¦ã€æ—¢å­˜ã®`Int`å‹ã®å€¤ã«`show`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹å®Ÿè£…ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚ã¾ãšæœ€åˆã«`show`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¦ã„ã‚‹`ShowIntOps`ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚
```scala
scala> class ShowIntOps(a: Int) {
     |   def show: String = a.toString
     | }
// class ShowIntOps
```
æ¬¡ã«`implciit conversion`ã‚’ç”¨ã„ã¦ã€`Int`å‹ã®å€¤ã‚’`ShowIntOps`ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å‹å¤‰æ›ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
```scala
scala> implicit def syntaxShowInt(a: Int): ShowIntOps = new ShowIntOps(a)
// def syntaxShowInt(a: Int): ShowIntOps
```

ã§ã¯`show`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã‚“ã§ã¿ã¾ã—ã‚‡ã†ã€‚
```scala
scala> 3.show
// val res0: String = 3
```
ä»¥ä¸Šã®ã‚ˆã†ã«ã—ã¦ã€`Emrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹æ—¢å­˜ã‚¯ãƒ©ã‚¹ã®æ‹¡å¼µã‚’è¡Œã†äº‹ãŒã§ãã¾ã—ãŸã€‚

### implicit class
`scala 2.10`ä»¥é™ã§ã¯ã‚¯ãƒ©ã‚¹å®šç¾©ã«`implicit`ä¿®é£¾å­ã‚’ã¤ã‘ã‚‹äº‹ã§ã€ä¸Šè¨˜ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰å®Ÿè£…ã‚’ã•ã‚‰ã«ç°¡æ½”ã«è¨˜è¿°ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚
```scala
scala> implicit class ShowIntOps(a: Int) {
     |   def show: String = a.toString
     | }
// class ShowIntOps

scala> 3.show
// val res0: String = 3
```

`Enrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å®Ÿè£…ã™ã‚‹å ´åˆã¯ã€åŸºæœ¬çš„ã«`implicit class`ã§è‰¯ã„ã‹ã¨ã¯æ€ã„ã¾ã™ãŒã€`implicit class`ã‚’ç”¨ã„ã¦ã„ãªã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚ã‚ã‚‹ã‚ˆã†ã§ã™ï¼ˆCatsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®`cats.syntax`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…ã¯`implicit class`ã‚’ä½¿ç”¨ã—ã¦ã„ãªã•ãã†ï¼‰ã€‚ãã®ãŸã‚ã©ã¡ã‚‰ã®å®Ÿè£…æ–¹æ³•ã‚‚èª­ã‚ã‚‹ã‚ˆã†ã«ã—ã¦ãŠãã¨è‰¯ã„ã®ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚

# Additiveå‹ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…
å‹ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã™ã‚‹æº–å‚™ãŒæ•´ã£ãŸã®ã§ã€ã„ã‚ˆã„ã‚ˆ`Additive`å‹ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

æœ¬è¨˜äº‹ã®ã‚´ãƒ¼ãƒ«ã§ã‚ã‚‹ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å†åº¦ç¢ºèªã—ã¾ã™ã€‚
```scala
...

class OptionInstancesTest extends AnyFunSuite {
  test("semigroup") {
    assert((Option(3)  |+| Option(4)) == Option(7))
    assert((Option(10) |+| Option(5)) == Option(15))
  }
}
```
æ­£ç›´ãªã¨ã“ã‚ã€`Option[Int]`å‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã‚ã‚Œã°ã€å‰ç¯€ã§èª¬æ˜ã—ãŸ`Enrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã¿ã‚’ç”¨ã„ãŸç°¡å˜ãªå®Ÿè£…ã§ã™ãã«ãƒ†ã‚¹ãƒˆã‚’é€šã›ã¾ã™ã€‚

ã—ã‹ã—å‹ã‚¯ãƒ©ã‚¹ã¯ã€**ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯å¤šç›¸ã‚’å®Ÿç¾ã™ã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³**ã¨ã„ã†èª¬æ˜ã«ã‚ã‚‹ã‚ˆã†ã«**å¤šç›¸æ€§**ã‚’æŒã¡åˆã‚ã›ã¦ã„ã‚‹äº‹ãŒé‡è¦ã§ã™ã€‚

ã“ã“ã‹ã‚‰ã¯Catsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è¨­è¨ˆãƒ»å®Ÿè£…ã‚’å‚è€ƒã«ã—ãªãŒã‚‰ã€`Additive`å‹ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…ã‚’è¡Œã£ã¦ã„ãã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç«‹ã¡ä¸Šã’
ä»Šå›ã®å®Ÿè£…ç’°å¢ƒã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚
```
sbt 1.4.1
scala 2.13.3
```

æœ€åˆã«`sbt new scala/scala-seed.g8`ã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã£ã¦ã€ã‚·ãƒ¼ãƒ‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯projectåã‚’çŒ«ç¹‹ãŒã‚Šã§`tabby`ï¼ˆãƒˆãƒ©çŒ«ï¼‰ã¨ã„ã†åå‰ã«ã—ã¦ã„ã¾ã™ã€‚

## å®Ÿè£…æ‰‹é †
å†’é ­ã§ã‚‚èª¬æ˜ã—ãŸä»¥ä¸‹ã®4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’é †ç•ªã«å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚
1. `trait`ã«ã‚ˆã‚‹å‹ã‚¯ãƒ©ã‚¹å®šç¾©
2. `implicit value`ã«ã‚ˆã‚‹å‹ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å®šç¾©
3. `implicit parameter`ã«ã‚ˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©
4. `Enrich my library`ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ`implicit conversion`ï¼‰ã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¹æ‹¡å¼µ

## 1. traitã«ã‚ˆã‚‹å‹ã‚¯ãƒ©ã‚¹å®šç¾©
`tabby`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä»¥ä¸‹ã«ã€`Additive`ãƒˆãƒ¬ã‚¤ãƒˆã‚’å®šç¾©ã—ã¾ã™ã€‚
```scala:src/main/scala/tabby/Additive.scala
package tabby

trait Additive[A] {
  def combine(x: A, y: A): A
}
```
`combine`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€`Additive`ãƒˆãƒ¬ã‚¤ãƒˆã®å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ä¸ãˆã‚‰ã‚ŒãŸå‹ã§ã‚ã‚‹2ã¤ã®å€¤ã‚’1ã¤ã«ã¾ã¨ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚æœ€çµ‚çš„ã«ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§å‘¼ã‚“ã§ã„ã‚‹`|+|`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€`combine`ãƒ¡ã‚½ãƒƒãƒ‰ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã«ãªã‚Šã¾ã™ã€‚

## 2. implicit valueã«ã‚ˆã‚‹å‹ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å®šç¾©
æ¬¡ã«`Additive[Int]`å‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™`implicit value`ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ä»Šå›`Int`å‹ã§ã‚ã‚‹2ã¤ã®å€¤ã‚’1ã¤ã«ã¾ã¨ã‚ã‚‹ã®ã¯åŠ ç®—ã§ã‚ã‚‹ã¨ã—ã¾ã™ã€‚
```scala:src/main/scala/tabby/instances/IntInstances.scala
package tabby
package instances

trait IntInstances {
  implicit val intAdditive: Additive[Int] = new Additive[Int] {
    def combine(x: Int, y: Int): Int = x + y
  }
}
```
Catsã§ã¯`cats.instances`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¸‹ã«ã€æ—¢å­˜ã®å‹åˆ¥ã«å‹ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™`implicit value`ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

`IntInstances`ãƒˆãƒ¬ã‚¤ãƒˆã§å®šç¾©ã—ãŸ`implicit value`ã‚’å–ã‚Šè¾¼ã¿ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãª`implicits`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
```scala:src/main/scala/tabby/implicits.scala
package tabby

object implicits
  extends instances.IntInstances
```
ã“ã‚Œã«ã‚ˆã‚Šã€
```scala
import tabby.implicits._
```
ã‚’ï¼‘è¡Œè¿½åŠ ã™ã‚‹ã ã‘ã§ã€`implicit value`ã‚’ã‚¹ã‚³ãƒ¼ãƒ—å†…ã«å–ã‚Šè¾¼ã‚€äº‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

Catsã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã¨ãŠã¾ã˜ãªã„ã®ã‚ˆã†ã«è¿½åŠ ã™ã‚‹
```scala
import cats.implicits._
```
ã¨åŒã˜å½¹å‰²ã§ã™ã€‚

ä»¥ä¸Šã®`implicit value`ã«ã‚ˆã‚Šã€`implicit parameter`ã«`Additive[Int]`å‹ã®å€¤ã‚’æ¸¡ã™æº–å‚™ãŒã§ãã¾ã—ãŸã€‚

## 3. implicit parameterã«ã‚ˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰å®šç¾©
ã“ã‚Œã¾ã§ã®å®Ÿè£…ã‚’ç”¨ã„ã¦ã€consoleå†…ã§`implicit parameter`ã‚’ç”¨ã„ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‹•ã‹ã—ã¦ã¿ã¾ã™ã€‚

ã¾ãšæœ€åˆã«`tabby.instances.IntInstances`å†…ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹`Additive[Int]`å‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’è¿”ã™`implicit value`ã‚’å–ã‚Šè¾¼ã¿ã¾ã™ã€‚
```scala
scala> import tabby.implicits._
// import tabby.implicits._
```
æ¬¡ã«`Additive[A]`å‹ã®`implicit value`ã‚’å—ã‘å–ã‚‹`implicit parameter`ã‚’ç”¨ã„ãŸ`combine`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚
```scala
scala> import tabby.Additive
// import tabby.Additive

scala> def combine[A](x: A, y: A)(implicit aa: Additive[A]): A = {
     |   aa.combine(x, y)
     | }
// def combine[A](x: A, y: A)(implicit aa: tabby.Additive[A]): A
```

å®Ÿéš›ã«`combine`